(this.webpackJsonpsport=this.webpackJsonpsport||[]).push([[0],{188:function(e,t,n){},268:function(e,t,n){"use strict";n.r(t);var a=n(276),c=n(41),r=n.n(c),i=n(0),o=n.n(i),s=n(26),u=n.n(s),d=(n(188),n(102)),j=n(25),l=n(122),b=n.n(l),h=n(146),m=n(162),f=n(47),p=n(163),O=n(271),x=n(75),g=n(278),v=n(273),I=n(275),T=n(274),y=n(277),w=n(272),S=n(279),k=n(280),C=n(76),P=n.n(C),R=n(147),M=n.n(R),B=n(13),L="V 2.5.6",D=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},E=function(e){return new Promise((function(t,n){var a={campusId:e,latitude:"30.786842".concat(D(1e4,99999)),longitude:"103.886128".concat(D(1e4,99999)),type:1};r.a.post("/running/api/v1/running/start",Object(f.a)({},a)).then((function(e){var n=e.randomCircuit;t(Object(f.a)({},n))})).catch((function(){n(!1)}))}))},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return new Promise((function(a,c){var i=Object(f.a)(Object(f.a)({},e),{},{time:P()().format("YYYY-MM-DD HH:mm:ss")}),o={circuitInfo:{circuitString:JSON.stringify(i)},version:L,valid:1,id:1,type:1,platform:1,stepRate:D(40,80),invalidReason:"",distance:t,validDistance:t,phone:"",startTime:P()().valueOf(),endTime:P()().add(n,"seconds").valueOf(),calories:parseInt(t/20)},s=[o.startTime+D(10,100),o.endTime-D(1500,2500)];o.totalTime=parseInt((s[1]-s[0])/1e3);for(var u=[],d=[],j=[],l=i.randomCircuit,b=l.requireLatitude,h=l.requireLongitude,m=0;m<3;m++)u.push(b[m]),d.push(h[m]),j.push(D(2,20));o.circuitInfo=Object(f.a)(Object(f.a)({},o.circuitInfo),{},{latitude:[u],longitude:[d],segment:[s],speed:j,calories:parseInt(t/20)}),o.md5=M()("EndRunningInfo{a='".concat(o.invalidReason,"', b=").concat(o.totalTime,", c=").concat(o.distance,", d=").concat(o.type,", e=").concat(o.startTime,", f=").concat(o.endTime,", g='").concat(o.phone,"'}"));var p={};Object.keys(o).sort().map((function(e){return p[e]=o[e]})),r.a.post("/running/api/v1/running/end3",p).then((function(e){a(e)})).catch((function(){c(!1)}))}))};var z=function(){var e=Object(i.useState)([]),t=Object(m.a)(e,2),n=t[0],c=t[1],o=Object(a.b)((function(e){return new Promise(function(){var t=Object(h.a)(b.a.mark((function t(n,a){var c,i,o,s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(e,t){r.a.get("/health/api/v1/homePage/user").then((function(t){var n=t.runningRule,a=n.rule,c=n.userCampus;e({rule:a,userCampus:c})})).catch((function(){t(!1)}))})).catch((function(){return a("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25")}));case 2:return c=t.sent,t.next=5,E(c.rule.campusId).catch((function(){return a("\u83b7\u53d6\u8dd1\u6b65\u4fe1\u606f\u5931\u8d25")}));case 5:return i=t.sent,t.next=8,q({runningRule:c,randomCircuit:i},e.distance,e.time).catch((function(e){a("\u7ed3\u675f\u8dd1\u6b65\u5931\u8d25")}));case 8:o=t.sent,s=o.invalidReason,1===o.valid?n(!0):a(s);case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}),{manual:!0,onSuccess:function(){p.b.success("\u8dd1\u6b65\u5b8c\u6210"),f()},onError:function(e){p.b.error(e),f()}}),s=o.loading,u=o.run,j=Object(a.b)((function(){return e=1,new Promise((function(t,n){var a=P()().subtract(90,"days").valueOf(),c=P()().valueOf();r.a.post("running/api/v1/running/recordList",{pageNum:e,pageSize:20,startTime:a,endTime:c}).then((function(e){t(e.items)})).catch((function(e){n("\u83b7\u53d6\u5217\u8868\u5931\u8d25")}))}));var e}),{manual:!0,onSuccess:function(e){c(e),console.log(e)},onError:function(e){p.b.error(e)}}),l=j.loading,f=j.run;return Object(i.useEffect)((function(){f()}),[]),Object(B.jsx)(B.Fragment,{children:Object(B.jsx)(O.a,{title:"\u4e50\u5065",subTitle:"\u5b8c\u5168\u514d\u8d39",extra:Object(B.jsx)(d.b,{to:"/login",children:Object(B.jsx)(x.a,{type:"link",children:"\u5207\u6362\u8d26\u53f7"})}),children:Object(B.jsxs)(g.b,{direction:"vertical",style:{width:"100%"},size:"large",children:[Object(B.jsxs)(v.a,{title:"\u544a\u77e5",children:[Object(B.jsxs)(I.a.Text,{children:["1.\u672c\u529f\u80fd\u5c5e\u4e8e\u7eaf\u524d\u7aef\u5b9e\u73b0\uff0c\u4e0d\u5b58\u5728\u6536\u96c6\uff0c\u4fdd\u7559\u7528\u6237\u4fe1\u606f\u7b49",Object(B.jsx)("br",{})]}),Object(B.jsxs)(I.a.Text,{children:["2.\u4ec5\u4f9b\u5b66\u4e60\u7814\u7a76\u4f7f\u7528\uff0c\u5207\u52ff\u7528\u4e8e\u975e\u6cd5\u6216\u5546\u4e1a\u7b49\u7528\u9014",Object(B.jsx)("br",{})]}),Object(B.jsxs)(I.a.Text,{children:["3.\u5b8c\u5168\u514d\u8d39\u5f00\u6e90\uff0c\u8bf7\u52ff\u4e0a\u5f53\u53d7\u9a97\uff0c\u5982\u679c\u4f60\u662f\u6536\u8d39\u770b\u5230\u9875\u9762\uff0c\u8bf7\u53ca\u65f6\u4e3e\u62a5\u8bc8\u9a97\u8005",Object(B.jsx)("br",{})]}),Object(B.jsxs)(I.a.Text,{children:["4.github:",Object(B.jsx)("a",{href:"https://github.com/jwjjgs/sport_jwjjgs_cn",children:"\u70b9\u6211\u8fdb\u5165"}),Object(B.jsx)("br",{})]})]}),Object(B.jsxs)(T.a,{onFinish:function(e){u(e)},children:[Object(B.jsx)(T.a.Item,{name:"distance",children:Object(B.jsx)(y.a,{addonBefore:"\u8ddd\u79bb",addonAfter:"\u7c73"})}),Object(B.jsx)(T.a.Item,{name:"time",children:Object(B.jsx)(y.a,{addonBefore:"\u65f6\u95f4",addonAfter:"\u79d2"})}),Object(B.jsx)(T.a.Item,{children:Object(B.jsx)(x.a,{htmlType:"submit",type:"primary",block:!0,loading:s,children:"\u5954\u8dd1"})})]}),Object(B.jsx)(w.b,{loading:l,itemLayout:"horizontal",dataSource:n,renderItem:function(e){return Object(B.jsxs)(w.b.Item,{children:[Object(B.jsx)(w.b.Item.Meta,{avatar:1===e.valid?Object(B.jsx)(S.a,{twoToneColor:"#52c41a"}):Object(B.jsx)(k.a,{twoToneColor:"#eb2f96"}),title:"ID:".concat(e.id),description:"\u8ddd\u79bb:".concat(e.validDistance,"m \u65f6\u95f4:").concat(e.totalTime,"s")}),Object(B.jsx)("div",{children:e.startTime})]})}})]})})})};var F=function(){var e=Object(j.g)(),t=Object(a.b)((function(e){return{url:"/health/api/v1/login",method:"post",data:Object(f.a)(Object(f.a)({},e),{},{orgId:368})}}),{manual:!0,onSuccess:function(t){var n=t.token;localStorage.setItem("token","Bearer ".concat(n)),p.b.success("\u767b\u9646\u6210\u529f"),e.push("/")}}),n=t.loading,c=t.run;return Object(B.jsx)(B.Fragment,{children:Object(B.jsx)(O.a,{title:"\u767b\u5f55",children:Object(B.jsxs)(T.a,{onFinish:function(e){return c(e)},initialValues:{username:"",password:""},children:[Object(B.jsx)(T.a.Item,{name:"username",children:Object(B.jsx)(y.a,{addonBefore:"\u8d26\u53f7"})}),Object(B.jsx)(T.a.Item,{name:"password",children:Object(B.jsx)(y.a.Password,{addonBefore:"\u5bc6\u7801"})}),Object(B.jsx)(T.a.Item,{children:Object(B.jsx)(x.a,{htmlType:"submit",type:"primary",block:!0,loading:n,children:"\u767b\u5f55\u4e50\u5065"})})]})})})};var J=function(){return Object(B.jsx)(d.a,{children:Object(B.jsxs)(j.d,{children:[Object(B.jsx)(j.b,{path:"/login",component:F}),Object(B.jsx)(j.b,{path:"/",render:function(){return localStorage.getItem("token")?Object(B.jsx)(z,{}):Object(B.jsx)(j.a,{to:"/login"})}})]})})};r.a.defaults.baseURL="https://upes.legym.cn/",r.a.defaults.headers.post["Content-Type"]="application/json;; charset=utf-8",r.a.interceptors.request.use((function(e){"post"===e.method.toLowerCase()&&"object"===typeof e.data&&(e.data=JSON.stringify(e.data));var t=localStorage.getItem("token");return t&&(e.headers.authorization=t),e})),r.a.interceptors.response.use((function(e){var t=e.data,n=t.code,a=t.message,c=t.data;return 0!==n?(p.b.warning(a||"\u672a\u77e5\u539f\u56e0"),Promise.reject()):(a&&p.b.success(a),c)})),u.a.render(Object(B.jsx)(o.a.StrictMode,{children:Object(B.jsx)(a.a,{value:{requestMethod:function(e){return r()(e)}},children:Object(B.jsx)(J,{})})}),document.getElementById("root"))}},[[268,1,2]]]);
//# sourceMappingURL=main.3330b6be.chunk.js.map