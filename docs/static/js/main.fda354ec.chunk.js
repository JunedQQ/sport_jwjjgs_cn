(this.webpackJsonpsport=this.webpackJsonpsport||[]).push([[0],{189:function(e,t,n){},269:function(e,t,n){"use strict";n.r(t);var a=n(277),r=n(34),c=n.n(r),i=n(0),s=n.n(i),o=n(26),u=n.n(o),d=(n(189),n(103)),j=n(25),l=n(124),b=n.n(l),m=n(148),h=n(107),f=n(52),p=n(164),O=n(272),g=n(75),x=n(279),v=n(273),I=n(276),y=n(274),T=n(278),w=n(275),S=n(280),k=n(281),C=n(76),L=n.n(C),P=n(149),R=n.n(P),q=n(11),M="V 2.5.6",B=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},E=function(e){return new Promise((function(t,n){var a={campusId:e,latitude:"30.786842".concat(B(1e4,99999)),longitude:"103.886128".concat(B(1e4,99999)),type:1};c.a.post("/running/api/v1/running/start",Object(f.a)({},a)).then((function(e){var n=e.randomCircuit;t(Object(f.a)({},n))})).catch((function(){n(!1)}))}))},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return new Promise((function(a,r){var i=Object(f.a)(Object(f.a)({},e),{},{time:L()().format("YYYY-MM-DD HH:mm:ss")}),s={circuitInfo:{circuitString:JSON.stringify(i)},version:M,valid:1,id:1,type:1,platform:1,stepRate:B(40,80),invalidReason:"",distance:t,validDistance:t,phone:"",startTime:L()().valueOf(),endTime:L()().add(n,"seconds").valueOf(),calories:parseInt(t/20)},o=[s.startTime+B(10,100),s.endTime-B(1500,2500)];s.totalTime=parseInt((o[1]-o[0])/1e3);for(var u=[],d=[],j=[],l=i.randomCircuit,b=l.requireLatitude,m=l.requireLongitude,h=0;h<3;h++)u.push(b[h]),d.push(m[h]),j.push(B(2,20));s.circuitInfo=Object(f.a)(Object(f.a)({},s.circuitInfo),{},{latitude:[u],longitude:[d],segment:[o],speed:j,calories:parseInt(t/20)}),s.md5=R()("EndRunningInfo{a='".concat(s.invalidReason,"', b=").concat(s.totalTime,", c=").concat(s.distance,", d=").concat(s.type,", e=").concat(s.startTime,", f=").concat(s.endTime,", g='").concat(s.phone,"'}"));var p={};Object.keys(s).sort().map((function(e){return p[e]=s[e]})),c.a.post("/running/api/v1/running/end3",p).then((function(e){a(e)})).catch((function(){r(!1)}))}))};var D=function(){var e=Object(i.useState)([]),t=Object(h.a)(e,2),n=t[0],r=t[1],s=Object(a.b)((function(e){return new Promise(function(){var t=Object(m.a)(b.a.mark((function t(n,a){var r,i,s,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(e,t){c.a.get("/health/api/v1/homePage/user").then((function(t){var n=t.runningRule,a=n.rule,r=n.userCampus;e({rule:a,userCampus:r})})).catch((function(){t(!1)}))})).catch((function(){return a("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25")}));case 2:return r=t.sent,t.next=5,E(r.rule.campusId).catch((function(){return a("\u83b7\u53d6\u8dd1\u6b65\u4fe1\u606f\u5931\u8d25")}));case 5:return i=t.sent,t.next=8,z({runningRule:r,randomCircuit:i},e.distance,e.time).catch((function(e){a("\u7ed3\u675f\u8dd1\u6b65\u5931\u8d25")}));case 8:s=t.sent,o=s.invalidReason,1===s.valid?n(!0):a(o);case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}),{manual:!0,onSuccess:function(){p.b.success("\u8dd1\u6b65\u5b8c\u6210"),f()},onError:function(e){p.b.error(e),f()}}),o=s.loading,u=s.run,j=Object(a.b)((function(){return e=1,new Promise((function(t,n){var a=L()().subtract(90,"days").valueOf(),r=L()().valueOf();c.a.post("running/api/v1/running/recordList",{pageNum:e,pageSize:20,startTime:a,endTime:r}).then((function(e){t(e.items)})).catch((function(e){n("\u83b7\u53d6\u5217\u8868\u5931\u8d25")}))}));var e}),{manual:!0,onSuccess:function(e){r(e),console.log(e)},onError:function(e){p.b.error(e)}}),l=j.loading,f=j.run;return Object(i.useEffect)((function(){f()}),[]),Object(q.jsx)(q.Fragment,{children:Object(q.jsx)(O.a,{title:"\u4e50\u5065",subTitle:"\u5b8c\u5168\u514d\u8d39",extra:Object(q.jsx)(d.b,{to:"/login",children:Object(q.jsx)(g.a,{type:"link",children:"\u5207\u6362\u8d26\u53f7"})}),children:Object(q.jsxs)(x.b,{direction:"vertical",style:{width:"100%"},size:"large",children:[Object(q.jsxs)(v.a,{title:"\u544a\u77e5",children:[Object(q.jsxs)(I.a.Text,{children:["1.\u672c\u529f\u80fd\u5c5e\u4e8e\u7eaf\u524d\u7aef\u5b9e\u73b0\uff0c\u4e0d\u5b58\u5728\u6536\u96c6\uff0c\u4fdd\u7559\u7528\u6237\u4fe1\u606f\u7b49",Object(q.jsx)("br",{})]}),Object(q.jsxs)(I.a.Text,{children:["2.\u4ec5\u4f9b\u5b66\u4e60\u7814\u7a76\u4f7f\u7528\uff0c\u5207\u52ff\u7528\u4e8e\u975e\u6cd5\u6216\u5546\u4e1a\u7b49\u7528\u9014",Object(q.jsx)("br",{})]}),Object(q.jsxs)(I.a.Text,{children:["3.\u5b8c\u5168\u514d\u8d39\u5f00\u6e90\uff0c\u8bf7\u52ff\u4e0a\u5f53\u53d7\u9a97\uff0c\u5982\u679c\u4f60\u662f\u6536\u8d39\u770b\u5230\u9875\u9762\uff0c\u8bf7\u53ca\u65f6\u4e3e\u62a5\u8bc8\u9a97\u8005",Object(q.jsx)("br",{})]}),Object(q.jsxs)(I.a.Text,{children:["4.github:",Object(q.jsx)("a",{href:"https://github.com/jwjjgs/sport_jwjjgs_cn",children:"\u70b9\u6211\u8fdb\u5165"}),Object(q.jsx)("br",{})]})]}),Object(q.jsxs)(y.a,{onFinish:function(e){u(e)},children:[Object(q.jsx)(y.a.Item,{name:"distance",children:Object(q.jsx)(T.a,{addonBefore:"\u8ddd\u79bb",addonAfter:"\u7c73"})}),Object(q.jsx)(y.a.Item,{name:"time",children:Object(q.jsx)(T.a,{addonBefore:"\u65f6\u95f4",addonAfter:"\u79d2"})}),Object(q.jsx)(y.a.Item,{children:Object(q.jsx)(g.a,{htmlType:"submit",type:"primary",block:!0,loading:o,children:"\u5954\u8dd1"})})]}),Object(q.jsx)(w.b,{loading:l,itemLayout:"horizontal",dataSource:n,renderItem:function(e){return Object(q.jsxs)(w.b.Item,{children:[Object(q.jsx)(w.b.Item.Meta,{avatar:1===e.valid?Object(q.jsx)(S.a,{twoToneColor:"#52c41a"}):Object(q.jsx)(k.a,{twoToneColor:"#eb2f96"}),title:"ID:".concat(e.id),description:"\u8ddd\u79bb:".concat(e.validDistance,"m \u65f6\u95f4:").concat(e.totalTime,"s")}),Object(q.jsx)("div",{children:e.startTime})]})}})]})})})},F=n(86);var J=function(){var e=Object(j.g)(),t=Object(i.useState)([]),n=Object(h.a)(t,2),r=n[0],s=n[1];Object(i.useEffect)((function(){c.a.get("/health/api/v2/organization/list",{params:{orgType:1}}).then((function(e){s(e.map((function(e){return{label:e.name,value:e.id}})))}))}),[]);var o=Object(a.b)((function(e){return{url:"/health/api/v1/login",method:"post",data:Object(f.a)({},e)}}),{manual:!0,onSuccess:function(t){var n=t.token;localStorage.setItem("token","Bearer ".concat(n)),p.b.success("\u767b\u9646\u6210\u529f"),e.push("/")}}),u=o.loading,d=o.run;return Object(q.jsx)(q.Fragment,{children:Object(q.jsx)(O.a,{title:"\u767b\u5f55",children:Object(q.jsxs)(y.a,{onFinish:function(e){return d(e)},initialValues:{username:"",password:""},children:[Object(q.jsx)(y.a.Item,{name:"username",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8d26\u53f7"}],children:Object(q.jsx)(T.a,{addonBefore:"\u8d26\u53f7",type:"tel",maxLength:11})}),Object(q.jsx)(y.a.Item,{name:"password",maxLength:16,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"}],children:Object(q.jsx)(T.a.Password,{addonBefore:"\u5bc6\u7801"})}),Object(q.jsx)(y.a.Item,{name:"orgId",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5730\u533a"}],children:Object(q.jsx)(F.a,{options:r})}),Object(q.jsx)(y.a.Item,{children:Object(q.jsx)(g.a,{htmlType:"submit",type:"primary",block:!0,loading:u,children:"\u767b\u5f55"})})]})})})};var Y=function(){return Object(q.jsx)(d.a,{children:Object(q.jsxs)(j.d,{children:[Object(q.jsx)(j.b,{path:"/login",component:J}),Object(q.jsx)(j.b,{path:"/",render:function(){return localStorage.getItem("token")?Object(q.jsx)(D,{}):Object(q.jsx)(j.a,{to:"/login"})}})]})})};c.a.defaults.baseURL="https://upes.legym.cn/",c.a.defaults.headers.post["Content-Type"]="application/json;; charset=utf-8",c.a.interceptors.request.use((function(e){"post"===e.method.toLowerCase()&&"object"===typeof e.data&&(e.data=JSON.stringify(e.data));var t=localStorage.getItem("token");return t&&(e.headers.authorization=t),e})),c.a.interceptors.response.use((function(e){var t=e.data,n=t.code,a=t.message,r=t.data;return 0!==n?(p.b.warning(a||"\u672a\u77e5\u539f\u56e0"),Promise.reject()):(a&&p.b.success(a),r)})),u.a.render(Object(q.jsx)(s.a.StrictMode,{children:Object(q.jsx)(a.a,{value:{requestMethod:function(e){return c()(e)}},children:Object(q.jsx)(Y,{})})}),document.getElementById("root"))}},[[269,1,2]]]);
//# sourceMappingURL=main.fda354ec.chunk.js.map